{{ define "content" }}
<div class="flex h-full">
  <!-- Left column (Tasks) -->
  <div class="w-1/4 border-r border-gray-300 pr-4">
    <!-- Task filter -->
    <div class="mb-4 flex items-center space-x-2">
      <button class="text-gray-500 hover:text-blue-500">Active</button>
      <button class="text-gray-500 hover:text-blue-500">Completed</button>
      <button class="text-gray-500 hover:text-blue-500">All</button>
    </div>

    <!-- Task list -->
    <div class="space-y-4" id="task-list">
      {{ range .Tasks }}
      <div
        class="flex cursor-move items-center space-x-3 rounded-lg p-3 shadow-md"
        style="background-color: {{ .Color }};"
      >
        <span class="flex-grow">{{ .Title }}</span>
        <button class="text-green-500 hover:text-green-700">Play</button>
        <button
          class="text-gray-500 hover:text-blue-500"
          hx-get="/tasks/{{ .ID }}/edit"
          hx-target="#modal-content"
          hx-trigger="click"
        >
          Edit
        </button>
      </div>
      {{ end }}
    </div>

    <!-- Create new task button -->
    <div class="mt-6">
      <button
        class="w-full rounded-lg bg-blue-500 py-2 text-white hover:bg-blue-700"
        hx-get="/tasks/new"
        hx-target="#modal-content"
        hx-trigger="click"
      >
        Create Task
      </button>
    </div>
  </div>

  <!-- Right column (Records) -->
  <div class="w-3/4 pl-4">
    <!-- List of records -->
    <div class="space-y-4">
      {{ range .Records }}
      <div class="relative flex items-center space-x-3 rounded-lg border border-gray-200 p-3 shadow-md">
        <div class="absolute top-0 h-1 rounded-full" style="background-color: {{ .Task.Color }}; width: 50%"></div>
        <span class="flex-grow">{{ .Comment }}</span>
        <button class="text-gray-500 hover:text-blue-500">Edit</button>
        <button class="text-red-500 hover:text-red-700">Delete</button>
        <button class="text-gray-500 hover:text-blue-500">Stop</button>
      </div>
      {{ end }}
    </div>
  </div>
</div>

<!-- Modal window -->
<div id="modal" class="fixed inset-0 z-50 flex hidden items-center justify-center bg-gray-800 bg-opacity-50">
  <div class="w-1/3 rounded-lg bg-white p-6 shadow-lg">
    <div id="modal-content">
      <!-- The content of the form will be loaded here via HTMX -->
    </div>
  </div>
</div>

<script>
  function closeModal() {
    document.getElementById("modal").classList.add("hidden");
  }

  document.addEventListener("htmx:afterOnLoad", function (event) {
    document.getElementById("modal").classList.remove("hidden");
  });

  document.addEventListener("htmx:configRequest", function (event) {
    if (event.detail.verb === "POST") {
      event.detail.headers["HX-Trigger"] = JSON.stringify({
        "refresh-dashboard": "#dashboard",
        "refresh-tasks": "#task-list",
      });
    }
  });
</script>
{{ end }}
